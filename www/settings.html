<head>
  <!-- Meta -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Kubek - Minecraft Servers</title>

  <!-- Bootstrap and Shards -->
  <script src="js/bootstrap.min.js"></script>
  <script src="js/shards.min.js"></script>
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/shards.min.css">

  <!-- Others -->
  <script src="js/jquery-3.6.0.min.js"></script>
  <script src="js/popper.min.js"></script>
  <link rel="stylesheet" href="css/animate.min.css" />
  <link rel="stylesheet" type="text/css" href="css/toastify.min.css">
  <script type="text/javascript" src="js/toastify-js.js"></script>
  <script src="js/sweetalert2.all.min.js"></script>
  <script src="js/progressbar.min.js"></script>

  <!-- Custom -->
  <script src="js/app.js"></script>
  <link rel="stylesheet" href="css/styles.css">

  <!-- Fonts and icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap"
    rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@700&display=swap" rel="stylesheet">
</head>

<body>
  <div class="mainLayout">
    <div class="menu">
      <div class="fc">
        <img src="assets/logo.svg" width="200px">
        <center>
          <p style="margin-top: 4px; width: max-content; height: min-content;" class="kubekVersion"></p>
        </center>

        <ul class="nav flex-column nav-pills nav-justified">
          <li class="nav-item">
            <a class="nav-link" href="/">{{servers}}</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="/settings.html">{{settings}}</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/passgen-tool.html">{{passgen}}</a>
          </li>
        </ul>
      </div>

      <div class="fc">

      </div>
    </div>
    <div class="layout" style="padding: 16px;">
      <p style="font-size: 28pt; font-weight: 700;">{{settings}}</p>
      <div class="setflex-c">
        <div class="setflex-b">
          {{softLang}}
        </div>
        <div class="setflex-b">
          <div class="custom-controls-stacked">
            <div class="custom-control custom-radio mb-3">
              <input type="radio" id="russianRadio" name="lang" value="ru" class="custom-control-input langRadio">
              <label class="custom-control-label" for="russianRadio">Русский</label>
            </div>
            <div class="custom-control custom-radio mb-3">
              <input type="radio" id="englishRadio" name="lang" value="en" class="custom-control-input langRadio">
              <label class="custom-control-label" for="englishRadio">English</label>
            </div>
          </div>
        </div>
      </div>
      <div class="setflex-c">
        <div class="setflex-b">
          {{ftpserver}}
        </div>
        <div class="setflex-b">
          <div class="custom-controls-stacked">
            <div class="custom-control custom-radio mb-3">
              <input type="radio" id="ftponRadio" name="ftp" value=true class="custom-control-input ftpRadio">
              <label class="custom-control-label" for="ftponRadio">{{on}}</label>
            </div>
            <div class="custom-control custom-radio mb-3">
              <input type="radio" id="ftpoffRadio" name="ftp" value=false class="custom-control-input ftpRadio">
              <label class="custom-control-label" for="ftpoffRadio">{{off}}</label>
            </div>
          </div>
        </div>
      </div>
      <div class="setflex-c">
        <div class="setflex-b">
          FTP {{user}}
        </div>
        <div class="setflex-b">
          <input type="text" style="width: 320px;" class="form-control ftpuser">
        </div>
      </div>
      <div class="setflex-c">
        <div class="setflex-b">
          FTP {{password}}
        </div>
        <div class="setflex-b">
          <div class="d-flex flex-row align-items-center">
            <div class="p-2"><input type="password" style="width: 320px;" class="form-control ftppass"></div>
            <div class="p-2"><span style="cursor: pointer; color: rgb(210,210,210);" class="material-icons eye"
                data-inp=".ftppass">visibility</span></div>
          </div>
        </div>
      </div>
      <div class="setflex-c">
        <div class="setflex-b">
          {{auth}}
        </div>
        <div class="setflex-b">
          <div class="custom-controls-stacked">
            <div class="custom-control custom-radio mb-3">
              <input type="radio" id="authonRadio" name="auth" value=true class="custom-control-input authRadio">
              <label class="custom-control-label" for="authonRadio">{{on}}</label>
            </div>
            <div class="custom-control custom-radio mb-3">
              <input type="radio" id="authoffRadio" name="auth" value=false class="custom-control-input authRadio">
              <label class="custom-control-label" for="authoffRadio">{{off}}</label>
            </div>
          </div>
        </div>
      </div>
      <div class="setflex-c">
        <div class="setflex-b">
          {{owner}} {{user}}
        </div>
        <div class="setflex-b">
          <input type="text" style="width: 320px;" class="form-control authuser">
        </div>
      </div>
      <div class="setflex-c">
        <div class="setflex-b">
          {{owner}} {{password}}
        </div>
        <div class="setflex-b">
          <div class="d-flex flex-row align-items-center">
            <div class="p-2"><input type="password" style="width: 320px;" class="form-control authpass"></div>
            <div class="p-2"><span style="cursor: pointer; color: rgb(210,210,210);" class="material-icons eye"
                data-inp=".authpass">visibility</span></div>
          </div>
        </div>
      </div>
      
      <button style="margin-top: 48px;" class="btn btn-primary saveBtn">{{ok}}</button>
    </div>
  </div>
</body>

<script>
  var kubekCfg;
  $(".kubekVersion").load("/kubek/version");

  $(document).ready(function () {
    $.get("/kubek/config", function (data) {
      kubekCfg = JSON.parse(data);
      if (kubekCfg['lang'] == "en") {
        $("#englishRadio").attr("checked", true);
      } else if (kubekCfg['lang'] == "ru") {
        $("#russianRadio").attr("checked", true);
      }

      if (kubekCfg['ftpd'] == true) {
        $("#ftponRadio").attr("checked", true);
      } else if (kubekCfg['ftpd'] == false) {
        $("#ftpoffRadio").attr("checked", true);
      }

      if (kubekCfg['auth'] == true) {
        $("#authonRadio").attr("checked", true);
      } else if (kubekCfg['auth'] == false) {
        $("#authoffRadio").attr("checked", true);
      }

      $(".ftppass").val(kubekCfg["ftpd-password"]);
      $(".ftpuser").val(kubekCfg["ftpd-user"]);
      $(".authpass").val(kubekCfg["owner-password"]);
      $(".authuser").val(kubekCfg["owner-user"]);
    });
  });

  $(".eye").click(function () {
    inp = $(this).data("inp");
    type = $(inp).attr("type");
    if (type == "password") {
      $(inp).attr("type", "text");
    } else {
      $(inp).attr("type", "password");
    }
  });

  $(".saveBtn").click(function () {
    checked = $(".langRadio:checked").val();
    ftpd = $(".ftpRadio:checked").val();
    auth = $(".authRadio:checked").val();
    ftpd == "true" ? ftpd = true : ftpd = false;
    console.log(ftpd);
    auth == "true" ? auth = true : auth = false;
    kubekCfg["lang"] = checked;
    kubekCfg["ftpd"] = ftpd;
    kubekCfg["auth"] = auth;
    kubekCfg["ftpd-password"] = $(".ftppass").val();
    kubekCfg["ftpd-user"] = $(".ftpuser").val();
    kubekCfg["owner-password"] = $(".authpass").val();
    kubekCfg["owner-user"] = $(".authuser").val();
    $.get("/kubek/saveConfig?data=" + encodeURI(JSON.stringify(kubekCfg)), function (data) {
      $.get("/ftpd/set?value=" + ftpd, function (data) {
        location.reload();
      });
    });
  });
</script>

<style>
  .setflex-c {
    display: flex;
    align-items: center;
    height: max-content;
  }

  .setflex-b {
    margin: 5px;
    padding: 5px;
    flex: 1 1 auto;
  }

  .setflex-b:nth-child(1) {
    width: 30%;
  }

  .setflex-b:nth-child(2) {
    width: min-content;
  }

  input {
    background: rgb(43, 53, 63) !important;
    border: none !important;
    outline: none !important;
    color: white !important;
  }
</style>